<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CSV to HTML Generator</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; }
    textarea { width: 100%; height: 200px; }
    pre { background: #f4f4f4; padding: 1rem; border-radius: 8px; white-space: pre-wrap; }
    button { padding: 0.5rem 1rem; margin-top: 1rem; }
  </style>
</head>
<body>

<h2>Paste your TSV data below:</h2>
<textarea id="csvInput" placeholder="Paste CATEGORY, SUBCATEGORY, SUB-SUBCATEGORY, LI-CODE tab-separated values here..."></textarea>
<br>
<button onclick="generateHTML()">Generate HTML</button>
<button onclick="clearFields()">Clear</button>

<h3>Generated HTML:</h3>
<pre id="output"></pre>

<script>
function generateHTML() {
  const input = document.getElementById("csvInput").value.trim();
  const lines = input.split(/\r?\n/);
  const output = document.getElementById("output");
  let currentCategory = "";
  let currentSubcategory = "";
  let currentHTML = "";
  const emoji = "ðŸŸ";

  function clearFields() {
  document.getElementById("csvInput").value = "";
  document.getElementById("output").textContent = "";
}

  
  lines.forEach(line => {
    const [cat, subcat, subsub, liCode] = line.split("\t").map(cell => cell?.trim() || "");
    if (!cat || !subcat || !subsub || !liCode) return;

    // New category
    if (cat !== currentCategory) {
      if (currentHTML) currentHTML += '</div>'; // Close previous subcategory block
      currentHTML += `\n<div class="category" onclick="toggle(this)"><span class="emoji">${emoji}</span> ${cat}</div>\n<div class="subcategory">`;
      currentCategory = cat;
      currentSubcategory = "";
    }

    // New subcategory
    if (subcat !== currentSubcategory) {
      currentHTML += `\n  <div class="sub-subcategory">\n    <h4>${subcat}</h4>\n    <ul>`;
      currentSubcategory = subcat;
    }

    // Add product item
    currentHTML += `\n      ${liCode}`;
    
    // Check if next line will start new subcategory or category
    const next = lines[lines.indexOf(line) + 1];
    if (!next || next.split("\t")[1]?.trim() !== subcat) {
      currentHTML += "\n    </ul>\n  </div>"; // Close sub-subcategory
    }
  });

  currentHTML += "\n</div>"; // Final close for subcategory
  output.textContent = currentHTML;
}
</script>

</body>
</html>
